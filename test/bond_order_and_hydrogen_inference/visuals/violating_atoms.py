
from pymol.cgo import *
from pymol import cmd
import numpy as np
from chempy.brick import Brick
from collections import defaultdict
positions_viewport_callbacks = defaultdict(lambda: defaultdict(lambda: ViewportCallback([],0,0)))


violating_atoms = [
        
COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-0.857,0.691,1.773,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-0.546,0.653,2.945,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-2.994,1.536,2.39,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-4.164,2.042,2.035,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-4.605,2.204,0.754,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-6.806,4.363,-1.073,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-7.619,4.284,-2.148,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-8.059,3.013,-2.587,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-8.793,2.917,-3.554,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-6.842,2.015,-0.86,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-6.488,1.011,-0.274,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-7.387,2.143,1.869,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,2.497,0.415,0.346,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,2.28,0.412,-0.847,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,6.027,1.24,-0.127,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,6.341,1.701,0.953,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,9.409,-0.015,-1.787,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,8.609,-0.971,-2.382,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,8.844,-2.318,-2.142,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,9.882,-2.7,-1.305,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,10.679,-1.739,-0.713,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,10.446,-0.399,-0.957,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,8.058,-3.26,-2.725,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,8.013,3.475,-1.189,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,6.925,3.94,-1.435,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,9.079,4.283,-1.081,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-2.48,-2.094,0.722,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-2.13,-2.581,1.776,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-5.413,-3.691,-1.099,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-6.428,-3.234,-0.286,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-7.75,-3.53,-0.604,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-8.044,-4.28,-1.731,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-7.022,-4.734,-2.542,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-5.71,-4.44,-2.226,0.3,COLOR,0.9677975592919913,0.44127456009157356,0.5358103155058701,1.0,SPHERE,-8.755,-3.084,0.195,0.3

            ]
cmd.load_cgo(violating_atoms, "violating_atoms", state=1)
        

cmd.set("cgo_transparency", 0, "violating_atoms")
    

for x in positions_viewport_callbacks:
    for y in positions_viewport_callbacks[x]:
        positions_viewport_callbacks[x][y].load()
